<h3>{% if app.request.get('q') %}
  Recherche : {{ app.request.get('q') }}
{% elseif app.request.get('playlist') %}
  {{ 'theaters.playlist.title'|trans }}
{% else %}
  {% if app.request.get('theater_ids') is null %}
  Séances près d'ici
  {% endif %}
{% endif %}</h3>
{% if cinemas|length == 0 %}
  {% if app.request.get('q') %}
    <p class="alert alert-warning">{{ 'program.theaters.noprogram.search'|trans }}</p>
  {% elseif app.request.get('playlist') %}
    <p class="alert alert-warning">{{ 'program.theaters.noprogram.playlist'|trans }} <a class="pull-right btn btn-suivre" data-modal="remote" data-modal-title="Ajouter un cinéma" href="{{ path('theaters_search', {'init': 1}) }}"><i class="glyphicon glyphicon-plus"></i> {{ 'theaters.playlist.add'|trans }}</a></p>
  {% elseif app.request.get('latlng') %}
    <p class="alert alert-warning">{{ 'program.theaters.noprogram.geoloc'|trans }}</p>
  {% endif %}
{% else %}


  <div class="panel-group" id="accordion-theaters">
  {% if radius is defined and radius > 10 %}
    <p class="alert alert-info">{{ 'program.theaters.extended.geoloc'|trans }}</p>
  {% endif %}
  {% for cinema in cinemas %}
    {% if cinema.adress is defined and cinema.schedules is defined %}
    <div class="panel panel-default panel-theater">
      <div class="panel-heading">
        <a class="btn btn-xs btn-default pull-right" href="{{path('any_url', {url: cinema.seo_url|slice(1, cinema.seo_url|length-1)}) }}">Films & horaires</a>
        <a class="accordion-toggle bold" data-toggle="collapse" data-parent="#accordion-theaters" href="#theater-{{ cinema.id }}"><i class="glyphicon glyphicon-resize-vertical hover hover-fade"></i> {{ cinema.name }}</a>
        {% if cinema.distance is defined %}<small class="grey">distance ≃ {{ cinema.distance < 1 ? (cinema.distance*100)|number_format ~'m' : cinema.distance|number_format(1) ~ 'km' }}</small>{% endif %}
      </div>
      <div id="theater-{{ cinema.id }}" class="panel-collapse collapse in{% if loop.first %}  in{% endif %}">
        <table class="table table-striped panel-body">
        <tr>
         {% for day in days if attribute(cinema.schedules, day) is defined %}
         <td class="theater-remote{% if loop.index == 1 %} live{% endif %}" data-theater-id="theater-{{ cinema.id }}" data-day="{{ day }}"><a>{{ day }}</a></td>
         {% endfor %}
         </tr>

         {% for day in days if attribute(cinema.schedules, day) is defined %}
         <tr class="horaires {{ day }} {% if loop.index != 1%}hide{% endif %}">
          {% set s = attribute(cinema.schedules, day) %}
          {% set hasVF = 0 %}
          {% set hasVO = 0 %}
          {% for h in s.schedules|to_array %}
          {% if h.version == "VO"%}
          {% set hasVO = 1%}
          {% endif %}
          {% if h.version == "VF"%}
          {% set hasVF = 1%}
          {% endif %}
          {% endfor %}
            <td colspan="7">
              {% if hasVO == 1%}
              <span class="label label-default">VO</span>
              {% for h in s.schedules|to_array %}
              {% if h.version == "VO"%}
              {{ h.hour }}&nbsp;
              {% endif %}
              {% endfor %}
              {% endif %}
              {% if hasVF == 1 and hasVO == 1 %}
            </br>
              {% endif %}
              {% if hasVF == 1%}
              <span class="label label-default">VF</span>
              {% for h in s.schedules|to_array %}
              {% if h.version == "VF"%}
              {{ h.hour }}&nbsp;
              {% endif %}
              {% endfor %}
              {% endif%}
            </td>
          </tr>
          {% endfor %}
             </table>
    
        <p align="center">
          {% include 'SkreenHouseFactoryV3Bundle:Main:_btn-suivre.html.twig' with {id: cinema.id, class: 'fav-cinema fav-remove', name: cinema.name, text: 'Ajouter ' ~ cinema.name ~ ' à vos cinémas'} %}
        </p>
      </div>
    </div>
    {% endif %}
  {% endfor %}
  </div>
{% endif %}